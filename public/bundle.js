!function(){var e={},t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e=function(){return t(n),n}}else{var r=new Array(16);e=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}for(var a=[],i=0;i<256;++i)a[i]=(i+256).toString(16).substr(1);var o,u,l=0,c=0,s=function(t,n,r){var i=n&&r||0,s=n||[],f=(t=t||{}).node||o,d=void 0!==t.clockseq?t.clockseq:u;if(null==f||null==d){var p=e();null==f&&(f=o=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=u=16383&(p[6]<<8|p[7]))}var h=void 0!==t.msecs?t.msecs:(new Date).getTime(),v=void 0!==t.nsecs?t.nsecs:c+1,y=h-l+(v-c)/1e4;if(y<0&&void 0===t.clockseq&&(d=d+1&16383),(y<0||h>l)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=h,c=v,u=d;var m=(1e4*(268435455&(h+=122192928e5))+v)%4294967296;s[i++]=m>>>24&255,s[i++]=m>>>16&255,s[i++]=m>>>8&255,s[i++]=255&m;var w=h/4294967296*1e4&268435455;s[i++]=w>>>8&255,s[i++]=255&w,s[i++]=w>>>24&15|16,s[i++]=w>>>16&255,s[i++]=d>>>8|128,s[i++]=255&d;for(var b=0;b<6;++b)s[i+b]=f[b];return n||function(e,t){var n=t||0,r=a;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}(s)},f={};(function(e){"use strict";var t=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function u(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(u){i=[6,u],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(u){a={error:u}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(f,"__esModule",{value:!0});var o=a("undefined"!=typeof window?window.React:void 0!==e?e.React:null),u=i("undefined"!=typeof window?window.axios:void 0!==e?e.axios:null),l=i(s),c=MaterialUI.Button,d=MaterialUI.IconButton,p=MaterialUI.Icon,h=MaterialUI.Grid,v=MaterialUI.List,y=MaterialUI.ListItem,m=MaterialUI.ListItemSecondaryAction,w=MaterialUI.ListSubheader,b=MaterialUI.TextField;f.default=function(){var e=r(o.useState([]),2),a=e[0],i=e[1],s=o.useRef(),f=o.useRef(),g=o.useRef(),_=function(){return t(void 0,void 0,void 0,function(){var e;return n(this,function(t){switch(t.label){case 0:return[4,u.default.post("/api/lst",{gameName:g.current.value})];case 1:return t.sent(),e=i,[4,u.default.post("/api/lst",{gameName:g.current.value})];case 2:return e.apply(void 0,[t.sent().data]),[2]}})})},x=function(e){return t(void 0,void 0,void 0,function(){var t;return n(this,function(n){switch(n.label){case 0:return t=f.current,[4,u.default.post("/api/read",{gameName:g.current.value,sectionName:e})];case 1:return t.value=n.sent().data,s.current.value=e,f.current.focus(),[2]}})})};return o.default.createElement("div",null,o.default.createElement(h,{container:!0,spacing:3,style:{width:"100%"}},o.default.createElement(h,{item:!0,xs:3},o.default.createElement(v,null,o.default.createElement(w,null,"Sections",o.default.createElement(m,null,o.default.createElement(c,{variant:"contained",disableElevation:!0,onClick:function(){return t(void 0,void 0,void 0,function(){var e;return n(this,function(t){switch(t.label){case 0:return e=prompt("Section name:")||l.default(),[4,u.default.post("/api/write",{gameName:g.current.value,sectionName:e,content:""})];case 1:return t.sent(),[4,_()];case 2:return t.sent(),[4,x(e)];case 3:return t.sent(),[2]}})})}},"Add"))),a.map(function(e){return o.default.createElement(y,{button:!0,key:e,onClick:function(){return x(e)}},e,o.default.createElement(m,null,o.default.createElement(d,{onClick:function(){return r=e,t(void 0,void 0,void 0,function(){return n(this,function(e){switch(e.label){case 0:return[4,u.default.post("/api/del",{gameName:g.current.value,sectionName:r})];case 1:return e.sent(),[4,_()];case 2:return e.sent(),[2]}})});var r}},o.default.createElement(p,null,"delete"))))}))),o.default.createElement(h,{item:!0,xs:9},o.default.createElement("div",{style:{width:"100%",padding:10}},o.default.createElement(b,{label:"Game name",InputLabelProps:{shrink:!0},inputRef:g,style:{marginRight:5},onKeyDown:function(e){"Enter"===e.key&&_()}}),o.default.createElement(b,{label:"Section name",InputLabelProps:{shrink:!0},inputRef:s,onKeyDown:function(e){"Enter"===e.key&&x(s.current.value)}})),o.default.createElement(b,{multiline:!0,variant:"filled",rows:"30",label:"Content",InputLabelProps:{shrink:!0},inputRef:f,style:{width:"100%"},inputProps:{style:{fontFamily:"monospace"}},onBlur:function(){u.default.post("/api/write",{gameName:g.current.value,sectionName:s.current.value,content:f.current.value})}}))))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var d={};(function(e){"use strict";var t=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function u(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u)}l((r=r.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(u){i=[6,u],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(u){a={error:u}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},a=this&&this.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(d,"__esModule",{value:!0});var o=i("undefined"!=typeof window?window.axios:void 0!==e?e.axios:null),u=function(){function e(){this.text="",this.curText="",this.backgroundImageChanged=!1}return Object.defineProperty(e.prototype,"backgroundImage",{get:function(){return this._backgroundImage||"/transparent.png"},set:function(e){this._backgroundImage=e,this.backgroundImageChanged=!0},enumerable:!0,configurable:!0}),e.prototype.applyText=function(e){this.text+=this.curText,this.curText=e},e}(),l={},c={"\\char":function(e,r){return t(void 0,void 0,void 0,function(){return n(this,function(t){switch(t.label){case 0:return r.length>1?e.state.char=r[1]:e.state.char=void 0,[4,c["\\clear"](e,[])];case 1:return t.sent(),[2,!1]}})})},"\\background-image":function(e,r){return t(void 0,void 0,void 0,function(){return n(this,function(t){return e.state.backgroundImage=r[1],[2,!1]})})},"\\newline":function(e,r){return t(void 0,void 0,void 0,function(){return n(this,function(t){return e.state.curText+="<br/>",[2,!1]})})},"\\clear":function(e,r){return t(void 0,void 0,void 0,function(){return n(this,function(t){return e.state.text=e.state.curText="",[2,Boolean(r[1])]})})},"\\goto":function(e,r){return t(void 0,void 0,void 0,function(){return n(this,function(t){switch(t.label){case 0:return[4,e.selectSection(r[1])];case 1:return t.sent(),[2,!1]}})})},"\\query":function(e,r){return t(void 0,void 0,void 0,function(){var t;return n(this,function(n){switch(n.label){case 0:return e.state.qid=r[1],t=e.state,[4,e.loadSection(r[1])];case 1:return t.qry=n.sent(),[2,!0]}})})},"\\options":function(e,r){return t(void 0,void 0,void 0,function(){var t;return n(this,function(n){switch(n.label){case 0:return e.state.qid=r[1],t=e.state,[4,e.loadSection(r[1])];case 1:return t.opts=n.sent().split("\n"),[2,!0]}})})}};l["\\script"]=1,c["\\script"]=function(e,r){return t(void 0,void 0,void 0,function(){return n(this,function(t){return new Function(r[1]).call(e),[2,!1]})})},c["\\beginscript"]=function(e,r){return t(void 0,void 0,void 0,function(){var t,r;return n(this,function(n){for(t=[];"\\endscript"!==(r=e.nextLine());)t.push(r);return new Function(t.join("\n")).call(e),[2,!1]})})};var s=function(){function e(e){this.cnt=0,this.cnt1=0,this.lst=[],this.lst1=[],this.ans={},this.data={},this.gameName=e,this.state=new u}return e.prototype.loadSection=function(e){return t(this,void 0,void 0,function(){return n(this,function(t){switch(t.label){case 0:return[4,o.default.post("/api/read",{gameName:this.gameName,sectionName:e})];case 1:return[2,t.sent().data]}})})},e.prototype.selectSection=function(e){return t(this,void 0,void 0,function(){var t;return n(this,function(n){switch(n.label){case 0:return t=this,[4,this.loadSection(e)];case 1:return t.lst=n.sent().split("\n"),this.lst1=[],this.cnt=this.cnt1=0,[2]}})})},e.prototype.addLine=function(e){this.lst1.push(e)},e.prototype.nextLine=function(){if(this.cnt1<this.lst1.length)return this.lst1[this.cnt1++];if(this.cnt<this.lst.length)return this.lst[this.cnt++];throw"No more lines."},e.prototype.next=function(){return t(this,void 0,void 0,function(){var e,t,r,i;return n(this,function(n){switch(n.label){case 0:e=!1,n.label=1;case 1:return e?[3,9]:(t=this.nextLine()).startsWith("\\")?[3,5]:""!==t?[3,3]:[4,c["\\newline"](this,[])];case 2:return e=n.sent(),[3,4];case 3:return this.state.applyText(t),[3,9];case 4:return[3,8];case 5:return(r=t.split(" "))[0]in c?(r[0]in l&&(i=l[r[0]],r=a(r.slice(0,i),[r.slice(i).join(" ")])),[4,c[r[0]](this,r.filter(Boolean))]):[3,7];case 6:return e=n.sent(),[3,8];case 7:throw"Unexpected token "+r[0];case 8:return[3,1];case 9:return[2]}})})},e}();d.default=s}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var p={};(function(e){"use strict";var t=this&&this.__assign||function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function u(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,u)}l((r=r.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(u){i=[6,u],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(u){a={error:u}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(p,"__esModule",{value:!0});var l=o("undefined"!=typeof window?window.React:void 0!==e?e.React:null),c=u(d),s=u("undefined"!=typeof window?window.Typed:void 0!==e?e.Typed:null),f=(MaterialUI.Button,MaterialUI.Icon,MaterialUI.Card),h=MaterialUI.Divider,v=MaterialUI.Modal,y=MaterialUI.Backdrop,m=MaterialUI.Fade,w=MaterialUI.List,b=MaterialUI.ListItem,g=function(e){var n=e.src,r=e.style,i=a(e,["src","style"]);return l.default.createElement("div",t({style:Object.assign({position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundPosition:"center",backgroundSize:"cover",backgroundImage:'url("'+n+'")'},r)},i))},_={enter:1500,exit:500};p.default=function(e){var t=e.match.params.gameName,a=i(l.useState(!1),2),o=a[0],u=a[1],d=i(l.useState(),2),p=d[0],x=d[1],E=i(l.useState(""),2),k=E[0],S=E[1],I=i(l.useState(!0),2),M=(I[0],I[1]),R=i(l.useState(),2),O=R[0],P=R[1],C=i(l.useState(""),2),U=C[0],T=C[1],j=i(l.useState(!1),2),N=j[0],L=j[1],D=l.useRef(),q=l.useRef(),A=function(){S(/Android|iPhone/i.test(navigator.userAgent)?"8.5em":"12em")},B=function(){return D.current?D.current:D.current=new c.default(t)};l.useEffect(function(){n(void 0,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,B().selectSection("start")];case 1:return e.sent(),M(!1),A(),addEventListener("resize",A),addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1}),[2]}})})},[]);var F=function(){q.current.destroy(),q.current=void 0;var e=B();T(e.state.text+e.state.curText)},G=function(){return n(void 0,void 0,void 0,function(){var e,t;return r(this,function(n){switch(n.label){case 0:return e=B(),q.current?(F(),[3,3]):[3,1];case 1:return[4,e.next()];case 2:n.sent(),e.state.qry?(t=prompt(e.state.qry),e.ans[e.state.qid]=t,e.state.qry=void 0,G()):e.state.opts?L(!0):(P(e.state.char),T(e.state.text),q.current=new s.default("#type",{strings:[e.state.curText],typeSpeed:35,onComplete:function(){F()}})),e.state.backgroundImageChanged&&(e.state.backgroundImageChanged=!1,u(!1),setTimeout(function(){u(!0),setTimeout(function(){return x(e.state.backgroundImage)},1e3)})),n.label=3;case 3:return[2]}})})};return l.default.createElement(l.default.Fragment,null,p&&l.default.createElement(g,{src:"/res/"+t+p}),l.default.createElement(m,{in:o,timeout:{enter:1e3,exit:0}},l.default.createElement(g,{src:"/res/"+t+B().state.backgroundImage})),l.default.createElement(v,{open:N,BackdropComponent:y,BackdropProps:{transitionDuration:_}},l.default.createElement(m,{in:N,timeout:_},l.default.createElement("div",{style:{padding:"5% 10%",color:"white",height:"100%"}},l.default.createElement(w,null,N&&B().state.opts.map(function(e,t){return l.default.createElement(b,{key:t,button:!0,onClick:function(){return function(e,t){return n(void 0,void 0,void 0,function(){var n;return r(this,function(r){switch(r.label){case 0:return(n=B()).ans[n.state.qid]=[e,t],n.state.opts=void 0,L(!1),[4,G()];case 1:return r.sent(),[2]}})})}(t,e)}},e)}))))),l.default.createElement("div",{style:{width:"100%",height:k,padding:10,display:"flex",justifyContent:"center",position:"fixed",left:0,bottom:0}},l.default.createElement(f,{elevation:4,style:{width:"80%",backgroundColor:O?"#EEE":"#AAA",transition:"background-color 1s ease",padding:10,opacity:.8},onClick:G},O&&l.default.createElement("div",{style:{width:"30%"}},l.default.createElement("span",{style:{color:"#888"}},O),l.default.createElement(h,null)),l.default.createElement("div",{style:{padding:"0 10px"}},l.default.createElement("span",{dangerouslySetInnerHTML:{__html:U}}),l.default.createElement("span",{id:"type"})))))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var h={};(function(e){"use strict";var t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(h,"__esModule",{value:!0});var n=t("undefined"!=typeof window?window.React:void 0!==e?e.React:null),r=t(f),a=t(p),i=ReactRouterDOM.HashRouter,o=ReactRouterDOM.Switch,u=ReactRouterDOM.Route;ReactDOM.render(n.default.createElement(i,null,n.default.createElement(o,null,n.default.createElement(u,{path:"/game/:gameName",component:a.default}),n.default.createElement(u,{path:"/editor",component:r.default}))),document.querySelector("#app"))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}();